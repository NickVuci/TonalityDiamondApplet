/* Base styles */
:root{
--cell: 32px;   /* base tile size before scaling */
--gap: 1px;     /* grid gap between tiles */
--bg: #ffffff;
--ink: #0b0d10;
--panel-bg: rgba(247, 249, 252, 0.92);
--panel-border: #d8e0ec;
/* orientation variables */
--wrap-rot: -45deg;   /* default: horizontal unison */
--label-rot: 45deg;   /* keep labels upright */
}
html, body{ height:100%; }
body{ margin:0; background:var(--bg); color:var(--ink); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }

/* Fullscreen viewport */
#viewport{ position: fixed; inset: 0; overflow: hidden; background: var(--bg); touch-action: none; -webkit-tap-highlight-color: transparent; }

/* Floating menu in upper-left (collapsible) */
#menu{ position: absolute; top: 14px; left: 14px; z-index: 50; background: var(--panel-bg); backdrop-filter: blur(6px); border: 1px solid var(--panel-border); border-radius: 12px; padding: 10px 12px; max-width: 520px; box-shadow: 0 6px 24px rgba(0,0,0,.08); transition: width .18s ease, height .18s ease, padding .18s ease, opacity .18s ease, transform .18s ease; touch-action: auto; }
#menu .title{ display:flex; align-items:center; justify-content:space-between; gap:10px; }
#menu .title .name{ font-size:16px; margin:0; font-weight:700; }
#menu .title .toggle{ appearance:none; border:1px solid var(--panel-border); background:#fff; border-radius:10px; padding:6px 10px; cursor:pointer; font-weight:700; }
#menu .title .toggle:active{ transform:translateY(1px); }
#menuContent{ margin-top:8px; }
#menu.collapsed{ padding: 6px 8px; width:auto; height:auto; }
#menu.collapsed #menuContent{ display:none; }
#menu.collapsed .name{ display:none; }
#menu.collapsed .toggle{ font-size:14px; padding:6px 8px; }
#menu .row{ display:flex; flex-wrap:wrap; gap:12px; align-items:end; }
#menu fieldset{ border:1px solid var(--panel-border); border-radius:10px; padding:8px 10px; }
#menu fieldset legend{ color:#6f7f93; padding:0 6px; font-size:12px; }
#menu label{ display:block; font-size:12px; color:#637389; margin-bottom:4px; }
#menu input[type="number"], #menu input[type="text"], #menu select{ background:#fff; border:1px solid #cfd8e4; color:#0b0d10; padding:6px 8px; border-radius:8px; width: 100%; }
.btn{ background:#124ae4; color:#fff; border:0; padding:8px 12px; border-radius:10px; font-weight:600; cursor:pointer; box-shadow: 0 2px 0 rgba(0,0,0,.06); }
.btn.small{ padding:6px 10px; font-size:12px; }
.btn.secondary{ background:#eff3f9; color:#0b0d10; }
.btn.ghost{ background:transparent; border:1px solid var(--panel-border); }
.danger{ background:#e2123c; }
.inline{ display:flex; gap:6px; align-items:center; }
.controls{ display:flex; flex-wrap:wrap; gap:8px; }
.muted{ color:#75839a; font-size:12px; }
#instructions {
  background: var(--panel-bg);
  backdrop-filter: blur(6px);
  border: 1px solid var(--panel-border);
  border-radius: 12px;
  padding: 10px 12px;
  max-width: 520px;
  box-shadow: 0 6px 24px rgba(0,0,0,.08);
  transition: width .18s ease, height .18s ease, padding .18s ease, opacity .18s ease, transform .18s ease;
  touch-action: auto;
}
#instructions .title { display:flex; align-items:center; justify-content:space-between; gap:10px; }
#instructions .name { font-size:16px; margin:0; font-weight:700; }
#instructions .toggle { appearance:none; border:1px solid var(--panel-border); background:#fff; border-radius:10px; padding:6px 10px; cursor:pointer; font-weight:700; }
#instructions .toggle:active { transform:translateY(1px); }
#instructionsContent { margin-top:8px; }
#instructions.collapsed { padding: 6px 8px; width:auto; height:auto; }
#instructions.collapsed #instructionsContent { display:none; }
#instructions.collapsed .name { display:none; }
#instructions.collapsed .toggle { font-size:14px; padding:6px 8px; }


/* Diamond wrapper is centered and scaled/rotated by JS */
#diamondWrap{ position:absolute; top:50%; left:50%; transform-origin:center center; will-change: transform; }

/* Grid stage (unrotated in CSS; rotated via parent) */
.stage{ position: relative; width: max-content; height: max-content; display: grid; grid-gap: var(--gap); }

/* Tiles and visuals */
.tile{ width: var(--cell); height: var(--cell); position: relative; border: 1px solid #ffffff; background: transparent; touch-action: none; overflow: hidden; }
.tile .cell{ position:absolute; inset:0; transform: rotate(var(--label-rot)); transform-origin:center center; }

.tile:not(.axis) .cell::before{ content: ""; position:absolute; inset:-25%; background: linear-gradient(to bottom, var(--numColor, #cbd5e1) 0 50%, var(--denColor, #cbd5e1) 50% 100%); transform: scale(1.45); transform-origin: 50% 50%; z-index:0; }

.tile.axis{ background:#fff; cursor:pointer; }
.tile.axis .label{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size: 12px; }
.tile.play{ outline: none !important; }
.tile:focus, .tile.axis:focus{ outline: none !important; }
.tile.axis.armed{ outline: none !important; }

.tip{ position:absolute; bottom:100%; left:50%; transform: translate(-50%,-6px); background: rgba(0,0,0,.85); color:#fff; font-size: 11px; border-radius: 6px; padding: 6px 7px; white-space: nowrap; pointer-events:none; opacity:0; transition: opacity .12s ease; z-index:2; }
.tile:hover .tip{ opacity:1; }
.hidden{ display:none; }

/* Audio banner */
#audioBanner{ position:absolute; z-index:55; top:14px; left:50%; transform:translateX(-50%); background: rgba(255,255,255,.95); border:1px solid var(--panel-border); border-radius: 10px; box-shadow: 0 6px 24px rgba(0,0,0,.08); padding: 8px 10px; display:flex; gap:10px; align-items:center; transition: opacity .18s ease; opacity:1; }
#audioBanner.hidden{ opacity:0; pointer-events:none; }
#audioBanner .msg{ font-size: 12px; color:#0b0d10; }

/* Grid styling */
:root{ --grid-color:#0b0d10; --grid-width:2px; }
.tile{ border: var(--grid-width) solid var(--grid-color) !important; }
.tile:not(.axis) .cell::after{ content:""; position:absolute; left:-35%; right:-35%; top:50%; height:0; border-top: var(--grid-width) solid var(--grid-color); z-index:2; }
.tile .label{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:3; pointer-events:none; }
.tile .frac{ position:absolute; inset:0; line-height:1; color: var(--grid-color); }
.tile .frac .n, .tile .frac .d{ position:absolute; left:50%; transform: translate(-50%, -50%); font-weight:700; font-size: calc(var(--cell) * 0.46); text-shadow: 0 1px 2px rgba(255,255,255,.55); }
.tile .frac .n{ top:25%; }
.tile .frac .d{ top:75%; }
.tile .frac .bar{ display:none !important; width:0; height:0; border:0; margin:0; }
.tile.axis .label{ z-index:3; }

/* Prevent text selection/highlight inside the diamond grid */
#stage, #stage *{ -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
